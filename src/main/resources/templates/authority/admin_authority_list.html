<!DOCTYPE html>
<html xmlns:th=“http://www.thymeleaf.org”>
<th:block
	th:replace="~{/layout/y4j_layout :: funcLayout(~{:: .fragment})}">

	<div class="fragment">
		<div class="fragment-inner">

			<form name="adminAuthSearchForm" action="admin_authority_list">
				<div class="aal-top">
					<div class="aal-top-left">
						<span class="aal-top-lefts sideMenuTitle">메인 타이틀</span>
						<span>></span>
						<span class="aal-top-lefts sideMenuContent">서브 타이틀</span>
					</div>
					<div class="aal-top-right">
						<input type="text" name="searchValue" placeholder="이름 검색" />
						<button class="btn btn-outline-dark" type="submit">검색</button>
					</div>
				</div>
				<input type="hidden" name="pageNum" value="1" />
				<input type="hidden" name="amount" th:value="${pageVO.amount }" />
			</form>

			<div class="aal-content">
				<div class="aal-table-outer">
					<table class="table table-striped table-hover">
						<thead class="table-dark">
							<tr>
								<th scope="col">연번</th>
								<th scope="col">관리자 번호</th>
								<th scope="col">이름</th>
								<th scope="col">관리자 타입</th>
								<th scope="col">등록 날짜</th>
								<th scope="col">비고</th>
							</tr>
						</thead>
						<tbody class="table-group-divider">
							<tr th:each="vo, s : ${list}">
								<td>[[${pageVO.total - (pageVO.pageNum - 1) * pageVO.amount - s.count + 1}]]</td>
								<td>[[${vo.admin_no}]]</td>
								<td>[[${vo.admin_name}]]</td>
								<td>[[${vo.admin_type}]]</td>
								<td>[[${ #temporals.format(vo.admin_regdate, 'yyyy-MM-dd') }]]</td>
								<td><button type="button" class="btn btn-dark showModal" data-bs-toggle="modal" data-bs-target="#exampleModal">세부 정보</button></td>
							</tr>
						</tbody>
					</table>

					<!-- Modal -->
					<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
						<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
							<div class="modal-content">
								<div class="modal-header">
									<h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
									<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
								</div>
								<div class="modal-body">
									...
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
									<button type="button" class="btn btn-primary">Save changes</button>
								</div>
							</div>
						</div>
					</div>

					<!-- pagination -->
					<ul class="pagination" style="display: inline-flex">
						<li class="page-link">
							<a th:href="@{admin_authority_list(searchValue=${criteria.searchValue}, pageNum=1, amount=${pageVO.amount} ) }">
								<span aria-hidden="true">&laquo;</span>
							</a>
						</li>
						<th:block th:if="${pageVO.prev}">
							<li class="page-link">
								<a th:href="@{admin_authority_list(searchValue=${criteria.searchValue}, pageNum=${pageVO.startPage-1}, amount=${pageVO.amount} ) }">
									<span aria-hidden="true">&lsaquo;</span>
								</a>
							</li>
						</th:block>
						<th:block th:each="p, s : ${pageVO.pageList}">
							<li class="p-li" th:class="${pageVO.pageNum == p ? 'on' : ''}"><a class="page-link" th:href="@{admin_authority_list(searchValue=${criteria.searchValue}, pageNum=${p}, amount=${pageVO.amount} ) }">[[${p}]]</a></li>
						</th:block>
						<th:block th:if="${pageVO.next}">
							<li class="page-link">
								<a th:href="@{admin_authority_list(searchValue=${criteria.searchValue}, pageNum=${pageVO.endPage+1}, amount=${pageVO.amount} ) }">
									<span aria-hidden="true">&rsaquo;</span>
								</a>
							</li>
						</th:block>
						<li class="page-link">
							<a th:href="@{admin_authority_list(searchValue=${criteria.searchValue}, pageNum=${pageVO.realEnd}, amount=${pageVO.amount} ) }">
								<span aria-hidden="true">&raquo;</span>
							</a>
						</li>
					</ul>
				</div>
			</div>

		</div>
	</div>

</th:block>

<script>
	$(".showModal").click(function(e) {

		var admin_no = $(this).parent().prev().prev().prev().prev().html();

		$.ajax({
			url: "../getAdminInfo",
			type: "post",
			data: JSON.stringify({admin_no: admin_no}),
			contentType: "application/json",
			success: function(result) {
				console.log(result);
				/*
				str += '<div class="left">';
				str += '<span>추가이미지</span>';
					str += '<label class="upload-display" for="' + arr[i] + '_file">';
						str += '<span class="upload-thumb-wrap">';
						str += '</span>';
					str += '</label>';
					str += '<input class="upload-name" value="파일선택" disabled="disabled">';
					str += '<input type="file" name="file" id="' + arr[i] + '_file" class="upload-hidden">';
					str += '<input type="hidden" value="">';
					str += '<input type="hidden" value="">';
					str += '<button type="button" class="normal_btn delete_btn" style="display: block;">삭제</button>';
					str += '<button type="button" class="normal_btn" style="display: block;" onclick="location.href=\'http://localhost:8181/download/' + result[i].filePath + '/' + result[i].uuid + '/' + result[i].fileName +'\'" >다운로드 - button 태그</button>';
					str += '<a class="normal_btn" href="http://localhost:8181/download/' + result[i].filePath + '/' + result[i].uuid + '/' + result[i].fileName +'">다운로드 - a태그</a>';
				str += '</div>';
					
				$(".filebox").append(str);
				*/
			},
			error: function(err) {
				alert("관리자 정보 조회에 실패했습니다.");
			}
		});
		
		
	});
</script>
<script>
	//모달을 닫을 시, 모달 화면에 구성해줬던 이미지 정보를 삭제
	// $(".modalOff").click(function(e) {
	// 	$(".left").remove();
	// });
</script>

</html>